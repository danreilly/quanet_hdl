<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">.lst-kix_bs9zmp44ac34-6>li{counter-increment:lst-ctn-kix_bs9zmp44ac34-6}ol.lst-kix_tcs3l8rbyjvz-2.start{counter-reset:lst-ctn-kix_tcs3l8rbyjvz-2 0}.lst-kix_tcs3l8rbyjvz-7>li:before{content:"" counter(lst-ctn-kix_tcs3l8rbyjvz-7,lower-latin) ". "}ol.lst-kix_tcs3l8rbyjvz-7{list-style-type:none}.lst-kix_tcs3l8rbyjvz-8>li:before{content:"" counter(lst-ctn-kix_tcs3l8rbyjvz-8,lower-roman) ". "}ol.lst-kix_tcs3l8rbyjvz-8{list-style-type:none}ol.lst-kix_bs9zmp44ac34-0.start{counter-reset:lst-ctn-kix_bs9zmp44ac34-0 0}.lst-kix_tcs3l8rbyjvz-2>li:before{content:"" counter(lst-ctn-kix_tcs3l8rbyjvz-2,lower-roman) ". "}.lst-kix_tcs3l8rbyjvz-4>li:before{content:"" counter(lst-ctn-kix_tcs3l8rbyjvz-4,lower-latin) ". "}.lst-kix_tcs3l8rbyjvz-5>li{counter-increment:lst-ctn-kix_tcs3l8rbyjvz-5}.lst-kix_tcs3l8rbyjvz-3>li:before{content:"" counter(lst-ctn-kix_tcs3l8rbyjvz-3,decimal) ". "}.lst-kix_tcs3l8rbyjvz-6>li:before{content:"" counter(lst-ctn-kix_tcs3l8rbyjvz-6,decimal) ". "}.lst-kix_bs9zmp44ac34-0>li{counter-increment:lst-ctn-kix_bs9zmp44ac34-0}ol.lst-kix_bs9zmp44ac34-7.start{counter-reset:lst-ctn-kix_bs9zmp44ac34-7 0}.lst-kix_tcs3l8rbyjvz-5>li:before{content:"" counter(lst-ctn-kix_tcs3l8rbyjvz-5,lower-roman) ". "}.lst-kix_tcs3l8rbyjvz-0>li{counter-increment:lst-ctn-kix_tcs3l8rbyjvz-0}.lst-kix_tcs3l8rbyjvz-6>li{counter-increment:lst-ctn-kix_tcs3l8rbyjvz-6}ol.lst-kix_bs9zmp44ac34-6.start{counter-reset:lst-ctn-kix_bs9zmp44ac34-6 0}ol.lst-kix_tcs3l8rbyjvz-5.start{counter-reset:lst-ctn-kix_tcs3l8rbyjvz-5 0}ol.lst-kix_tcs3l8rbyjvz-1.start{counter-reset:lst-ctn-kix_tcs3l8rbyjvz-1 0}.lst-kix_tcs3l8rbyjvz-3>li{counter-increment:lst-ctn-kix_tcs3l8rbyjvz-3}ol.lst-kix_bs9zmp44ac34-3.start{counter-reset:lst-ctn-kix_bs9zmp44ac34-3 0}.lst-kix_bs9zmp44ac34-5>li{counter-increment:lst-ctn-kix_bs9zmp44ac34-5}.lst-kix_bs9zmp44ac34-2>li{counter-increment:lst-ctn-kix_bs9zmp44ac34-2}ol.lst-kix_tcs3l8rbyjvz-8.start{counter-reset:lst-ctn-kix_tcs3l8rbyjvz-8 0}.lst-kix_bs9zmp44ac34-8>li{counter-increment:lst-ctn-kix_bs9zmp44ac34-8}ol.lst-kix_bs9zmp44ac34-3{list-style-type:none}.lst-kix_bs9zmp44ac34-3>li{counter-increment:lst-ctn-kix_bs9zmp44ac34-3}ol.lst-kix_bs9zmp44ac34-4{list-style-type:none}ol.lst-kix_bs9zmp44ac34-5{list-style-type:none}ol.lst-kix_bs9zmp44ac34-6{list-style-type:none}.lst-kix_bs9zmp44ac34-0>li:before{content:"" counter(lst-ctn-kix_bs9zmp44ac34-0,decimal) ". "}ol.lst-kix_bs9zmp44ac34-0{list-style-type:none}ol.lst-kix_tcs3l8rbyjvz-4.start{counter-reset:lst-ctn-kix_tcs3l8rbyjvz-4 0}ol.lst-kix_bs9zmp44ac34-1{list-style-type:none}ol.lst-kix_bs9zmp44ac34-2{list-style-type:none}ol.lst-kix_bs9zmp44ac34-7{list-style-type:none}ol.lst-kix_bs9zmp44ac34-5.start{counter-reset:lst-ctn-kix_bs9zmp44ac34-5 0}ol.lst-kix_bs9zmp44ac34-8{list-style-type:none}.lst-kix_tcs3l8rbyjvz-8>li{counter-increment:lst-ctn-kix_tcs3l8rbyjvz-8}.lst-kix_bs9zmp44ac34-5>li:before{content:"" counter(lst-ctn-kix_bs9zmp44ac34-5,lower-roman) ". "}.lst-kix_bs9zmp44ac34-6>li:before{content:"" counter(lst-ctn-kix_bs9zmp44ac34-6,decimal) ". "}ol.lst-kix_bs9zmp44ac34-2.start{counter-reset:lst-ctn-kix_bs9zmp44ac34-2 0}.lst-kix_tcs3l8rbyjvz-2>li{counter-increment:lst-ctn-kix_tcs3l8rbyjvz-2}ol.lst-kix_tcs3l8rbyjvz-7.start{counter-reset:lst-ctn-kix_tcs3l8rbyjvz-7 0}.lst-kix_bs9zmp44ac34-4>li:before{content:"" counter(lst-ctn-kix_bs9zmp44ac34-4,lower-latin) ". "}.lst-kix_bs9zmp44ac34-1>li:before{content:"" counter(lst-ctn-kix_bs9zmp44ac34-1,lower-latin) ". "}.lst-kix_bs9zmp44ac34-2>li:before{content:"" counter(lst-ctn-kix_bs9zmp44ac34-2,lower-roman) ". "}.lst-kix_bs9zmp44ac34-3>li:before{content:"" counter(lst-ctn-kix_bs9zmp44ac34-3,decimal) ". "}ol.lst-kix_bs9zmp44ac34-1.start{counter-reset:lst-ctn-kix_bs9zmp44ac34-1 0}ol.lst-kix_bs9zmp44ac34-4.start{counter-reset:lst-ctn-kix_bs9zmp44ac34-4 0}.lst-kix_bs9zmp44ac34-7>li{counter-increment:lst-ctn-kix_bs9zmp44ac34-7}.lst-kix_tcs3l8rbyjvz-0>li:before{content:"" counter(lst-ctn-kix_tcs3l8rbyjvz-0,decimal) ". "}.lst-kix_bs9zmp44ac34-7>li:before{content:"" counter(lst-ctn-kix_bs9zmp44ac34-7,lower-latin) ". "}.lst-kix_bs9zmp44ac34-4>li{counter-increment:lst-ctn-kix_bs9zmp44ac34-4}.lst-kix_tcs3l8rbyjvz-1>li:before{content:"" counter(lst-ctn-kix_tcs3l8rbyjvz-1,lower-latin) ". "}ol.lst-kix_tcs3l8rbyjvz-1{list-style-type:none}ol.lst-kix_tcs3l8rbyjvz-0.start{counter-reset:lst-ctn-kix_tcs3l8rbyjvz-0 0}ol.lst-kix_tcs3l8rbyjvz-2{list-style-type:none}ol.lst-kix_tcs3l8rbyjvz-6.start{counter-reset:lst-ctn-kix_tcs3l8rbyjvz-6 0}ol.lst-kix_tcs3l8rbyjvz-0{list-style-type:none}.lst-kix_bs9zmp44ac34-1>li{counter-increment:lst-ctn-kix_bs9zmp44ac34-1}ol.lst-kix_tcs3l8rbyjvz-5{list-style-type:none}.lst-kix_bs9zmp44ac34-8>li:before{content:"" counter(lst-ctn-kix_bs9zmp44ac34-8,lower-roman) ". "}ol.lst-kix_tcs3l8rbyjvz-6{list-style-type:none}ol.lst-kix_tcs3l8rbyjvz-3{list-style-type:none}ol.lst-kix_bs9zmp44ac34-8.start{counter-reset:lst-ctn-kix_bs9zmp44ac34-8 0}.lst-kix_tcs3l8rbyjvz-1>li{counter-increment:lst-ctn-kix_tcs3l8rbyjvz-1}ol.lst-kix_tcs3l8rbyjvz-4{list-style-type:none}.lst-kix_tcs3l8rbyjvz-4>li{counter-increment:lst-ctn-kix_tcs3l8rbyjvz-4}ol.lst-kix_tcs3l8rbyjvz-3.start{counter-reset:lst-ctn-kix_tcs3l8rbyjvz-3 0}.lst-kix_tcs3l8rbyjvz-7>li{counter-increment:lst-ctn-kix_tcs3l8rbyjvz-7}ol{margin:0;padding:0}table td,table th{padding:0}.c1{border-right-style:solid;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;padding-right:0pt}.c7{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:20pt;font-family:"Arial";font-style:normal}.c5{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Arial";font-style:normal}.c2{color:#636363;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10.5pt;font-family:"Arial";font-style:normal}.c16{padding-top:18pt;padding-bottom:6pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c18{padding-top:0pt;padding-bottom:0pt;line-height:1.42857;orphans:2;widows:2;text-align:left}.c0{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c12{color:#000000;font-weight:400;font-size:11pt;font-family:"Arial"}.c8{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.c19{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c3{font-size:12pt;font-weight:400;font-family:"Courier New"}.c14{background-color:#f5f5f5;color:#333333;font-size:10pt}.c11{text-decoration:none;vertical-align:baseline;font-style:normal}.c9{font-family:"Courier New";font-weight:400}.c13{color:inherit;text-decoration:inherit}.c4{color:#636363;font-size:10.5pt}.c20{font-size:11pt}.c6{height:11pt}.c21{font-size:10.5pt}.c15{color:#000000}.c17{text-indent:36pt}.c10{font-size:12pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c19 doc-content"><h2 class="c16" id="h.16xhdcdtbx03"><span class="c5">This is Dan&rsquo;s latest code for the zcu106:</span></h2><p class="c0 c6"><span class="c5"></span></p><p class="c0"><span class="c10">Copy this to the &nbsp;</span><span class="c3">/boot</span><span class="c5">&nbsp;partition of your SD card:</span></p><p class="c0 c6"><span class="c5"></span></p><p class="c0"><span class="c3 c11 c15">quanet_hdl/nucrypt_boot_objs/BOOT.BIN</span></p><p class="c0 c6"><span class="c5"></span></p><p class="c0 c6"><span class="c5"></span></p><p class="c0"><span class="c10">Copy this to the </span><span class="c3">/boot</span><span class="c10">&nbsp;partition of your SD card and name it </span><span class="c3">system.dtb</span></p><p class="c0 c6"><span class="c5"></span></p><p class="c0"><span class="c3 c11 c15">quanet_hdl/nucrypt_boot_objs/zynqmp-zcu106-fmcdaq3.dtb</span></p><p class="c0 c6"><span class="c12 c11"></span></p><p class="c0 c6"><span class="c12 c11"></span></p><p class="c1 c0 c6"><span class="c2"></span></p><p class="c1 c0 c6"><span class="c2"></span></p><p class="c1 c0 c6"><span class="c2"></span></p><p class="c0 c6"><span class="c12 c11"></span></p><p class="c0"><span class="c7">Porting Kuiper Linux to the ZCU106</span></p><p class="c1 c0 c6"><span class="c2"></span></p><p class="c0"><span>I got my 2022_r2 linux image from </span><span class="c8"><a class="c13" href="https://www.google.com/url?q=https://wiki.analog.com/resources/tools-software/linux-software/adi-kuiper_images/release_notes&amp;sa=D&amp;source=editors&amp;ust=1735941384350184&amp;usg=AOvVaw143B2drggsI1nZcIe-Poz1">https://wiki.analog.com/resources/tools-software/linux-software/adi-kuiper_images/release_notes</a></span></p><p class="c0"><span class="c4">This is about building Kuiper linux:</span></p><p class="c1 c0"><span class="c2">https://wiki.analog.com/resources/tools-software/linux-drivers-all</span></p><p class="c1 c0"><span class="c8 c21"><a class="c13" href="https://www.google.com/url?q=https://wiki.analog.com/resources/tools-software/linux-build/generic/zynqmp&amp;sa=D&amp;source=editors&amp;ust=1735941384351032&amp;usg=AOvVaw3N-CSNmDBV5_Ky_bZg55Ho">https://wiki.analog.com/resources/tools-software/linux-build/generic/zynqmp</a></span></p><p class="c1 c0"><span class="c2">On my VM I installed lex, bison, U-boot-tools, and &nbsp;libssl-dev</span></p><p class="c1 c0"><span class="c2">I also installed Vitis 2023.2</span></p><p class="c1 c0"><span class="c2">Then I cloned the AD Linux sources:</span></p><p class="c1 c0"><span class="c9 c4">git clone -b 2022_r2 &nbsp;https://github.com/analogdevicesinc/linux.git</span></p><p class="c1 c0"><span class="c2">Then I created the file:</span></p><p class="c0 c1"><span class="c11 c9 c4">linux/arch/arm64/boot/dts/xilinx/</span></p><p class="c1 c0 c17"><span class="c11 c9 c4">zynqmp-zcu106-fmcdaq3.dts</span></p><p class="c1 c0"><span class="c2">Which is based on a copy of the zcu102 dts,. &nbsp;(a copy of the original dts file is in my github in nucrypt_build_objs)</span></p><p class="c1 c0"><span class="c4">Here are the instructions specific to zynqmp:</span></p><p class="c1 c0"><span class="c2">https://wiki.analog.com/resources/tools-software/linux-build/generic/zynqmp</span></p><p class="c1 c0"><span class="c2">The AD instructions say to copy a build script, which I did and I called bldu.sh. &nbsp;Note that this is different from the zynq build script, I then modified bldu.sh so that you just run it and you can&rsquo;t specify any command line arguments, and it will build xilinx\zynqmp-zcu106-fmcdaq3.dtb. (a copy of bldu.sh is in my github in nucrypt_build_objs)</span></p><p class="c1 c0"><span class="c2">Since Vitis has the cross compiler, the next thing to do is to put that on the path:</span></p><p class="c0"><span class="c11 c9 c15 c20">source /tools/Xilinx/Vitis/2023.2/settings64.sh</span></p><p class="c0 c6"><span class="c11 c12"></span></p><p class="c0"><span>And if you don&rsquo;t do that, the </span><span class="c9">bdlu.sh</span><span class="c12 c11">&nbsp;script will download a different cross compiler (Linaro) and try to use it. &nbsp;I have not explored that method. &nbsp;Then I ran the script:</span></p><p class="c0 c6"><span class="c12 c11"></span></p><p class="c1 c18"><span class="c11 c9 c14">./bldu.sh</span></p><p class="c0"><span>It produced Image and </span><span class="c2">&nbsp;xilinx\zynqmp-zcu106-fmcdaq3.dtb, both of which I copied to github in &nbsp;nucrypt_build_objs.</span></p><p class="c0 c6"><span class="c2"></span></p><p class="c0"><span class="c2">I built my bitfile inside cygwin. &nbsp;You can also do this in linux, but I have not tried.</span></p><p class="c0"><span class="c11 c9 c4">cd quanet_hdl/projects/daq3/zcu106</span></p><p class="c0"><span class="c9 c4">make</span></p><p class="c0 c6"><span class="c2"></span></p><p class="c0"><span class="c2">This produces:</span></p><p class="c0"><span class="c9 c4 c11">hdl-main/projects/daq3/zcu106/daq3_zcu106.runs/impl/system_top.bit</span></p><p class="c0"><span class="c11 c9 c4">hdl-main/projects/daq3/zcu106/daq3_zcu106.sdk/system_top.xsa</span></p><p class="c0 c6"><span class="c2"></span></p><p class="c0"><span class="c4">There are probably better ways to make the BOOT.BIN, but for now I&rsquo;m using a method </span><span class="c12 c11">similar to AD&rsquo;s document on building BOOT.BIN:</span></p><p class="c0"><span class="c12 c11">https://analogdevicesinc.github.io/hdl/user_guide/build_boot_bin.html</span></p><p class="c0"><span class="c2">Which says to copy a script and run it. &nbsp;I did that, modified it, and named it (in my github) as:</span></p><p class="c0"><span class="c9 c4">projects/daq3/zcu106/build_boot.bat</span></p><p class="c1 c0"><span class="c4">This</span><span class="c2">&nbsp;script builds the fsbl.elf and the pmufw.elf file.</span></p><p class="c1 c0"><span class="c4">I did not build u-boot.elf. &nbsp;Both u-boot.elf and bl31.elf can be extracted from the project folder on the AD Kuiper linux SD Card image. &nbsp;After you put the image on an SD card, you can navigate (I used microsoft &ldquo;File Explorer&rdquo;) to the boot partition and get the stuff in </span><span class="c4 c9">/boot/zynqmp-zcu102-rev10-fmcdaq3</span><span class="c2">&nbsp;and unpack it. &nbsp;I put a copy of that directory on github under nucrypt_boot_objs and unpacked bootgen_sysfiles.tgz there. Note that this contains a BOOT.BIN for the zcu106, but I didn&rsquo;t use that or even try that. &nbsp;I only wanted the elf files.</span></p><p class="c1 c0"><span class="c2">I made my build_boot.bat pull those elf files into the BOOT.BIN that it builds.</span></p><p class="c1 c0"><span class="c2">zynqmp-zcu102-rev10-fmcdaq3.tar in </span></p><p class="c1 c0"><span class="c2">&nbsp;bootgen_sysfiles.tgz. &nbsp;I got this from Kuiper linux running on our zc706 board</span></p><p class="c1 c0 c6"><span class="c2"></span></p><p class="c1 c0 c6"><span class="c2"></span></p><p class="c1 c0"><span class="c2">&nbsp;It copies in the u-boot.elf and the b131.elf that I extracted from the SD card image from the zcu106 directory. &nbsp;Then it uses my zynq.bif file to put those four files and the bitfile into a BOOT.BIN file.</span></p><p class="c0"><span class="c2">The device tree must be named system.dtb (not devicetree.dtb)</span></p><p class="c0 c6"><span class="c2"></span></p><p class="c1 c0 c6"><span class="c2"></span></p><div><p class="c0 c6"><span class="c12 c11"></span></p></div></body></html>